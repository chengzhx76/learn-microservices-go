// flowhub.min.js v1.0.3
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,n){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).$hub=n()}(this,function(){"use strict";function h(t,n,e){void 0!==t[n]&&t[n].forEach(function(t,n){t(e)})}var d={iterator:function(t,n,e,o){var i=this;2!==arguments.length||e?3!==arguments.length||o?n<t.length?e(t[n],function(){i.iterator(t,++n,e,o)}):n>=t.length-1&&o&&o():this.iterator(t,0,n,e):this.iterator(t,0,n,null)},await:function(t,n){t.then?t.then(function(t){n&&n(t)}):n&&n(t)}};return{observer:{},data:{},chainer:{},socket:{ws:[]},emit:function(f,c){function t(t){var n,e,o,i;if(0===f.indexOf("@store/")&&(n=f.split("@store/")[1],void 0!==a[n]&&(a[n]=c)),0===f.indexOf("@chain/")){var r=f.split("@chain/")[1];if(void 0!==s[r])return e=s[r],o=c,i=function(t){h(u,f,t)},void d.iterator(e,function(t,n){d.await(t(o),function(t){o=t,n()})},function(){i(o)})}h(u,t,c)}var u=this.observer,a=this.data,s=this.chainer;f instanceof Array?f.forEach(t):t(f)},on:function(t,e){function n(t){var n;void 0===i[t]&&(i[t]=[]),i[t].push(e),0===t.indexOf("@store/")&&(n=t.split("@store/")[1],void 0!==r[n]&&e(r[n]))}var o=this,i=this.observer,r=this.data,f={};return(f.key=t)instanceof Array?(t.forEach(n),f.off=function(){return t.forEach(function(t){return o.off(t,e)})}):(n(t),f.off=function(){return o.off(t,e)}),f},off:function(t,o){function n(e){void 0!==i[e]&&i[e].forEach(function(t,n){t===o&&i[e].splice(n,1)})}var i=this.observer;t instanceof Array?t.forEach(n):n(t)},WS:function(t){var o=this;if(t){var i=this.emit,n=this.socket,e=this.converter,r={},f=[],c=new window.WebSocket(t);n.ws.push({url:t,socket:n}),r.socket=c;var u=function(n){if(n.data)try{a(JSON.parse(n.data))}catch(t){a(n.data)}else a(n)};c.addEventListener("message",u);var a=function(t){var e;0<f.length&&(e=t,d.iterator(f,function(t,n){switch(t.type){case"__convert__":d.await(t.func(e),function(t){e=t,n()});break;case"__emit__":t.func(e),n()}}))};return r.convert=function(t){return e[t]&&f.push({type:"__convert__",func:e[t]}),r},r.emit=function(n,e){return f.push({type:"__emit__",func:function(t){e?i.bind(o)(n,{result:t,data:e}):i.bind(o)(n,t)}}),r},r.off=function(){c.removeEventListener("message",u)},r}},chain:function(o){var i=this.chainer,r={pipe:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return i[o]?i[o]=i[o].concat(n):i[o]=n,r}};return r},converter:{},once:function(t,n){var e=this.on(t,function(t){n(t),e.off()})}}});
//# sourceMappingURL=flowhub.min.js.map
